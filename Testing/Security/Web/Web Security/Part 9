                    Web Security 
                    Course Notes Part 9


2 - Hardware
  - Demo of some pen testing hardware\software
    - WIFI Pineapple
      - The WiFi Pineapple lets pentesters perform targeted man-in-the-middle attacks, advanced reconnaissance, credential harvesting
      - https://docs.hak5.org/hc/en-us/categories/360000979333-WiFi-Pineapple
      - There are hardware disguises eg Smoke Alarm covers
    - Kali Linux
      - This is used by a lot of pen testers due to the amount of tools already installed
    - WiFi antenna (USB)
      - Hi powered antenna (10 - 15 times more powerful than installed hardware)
    - Femtocell
      - Creates a WiFi network
      - This can be a security risk as devices will join automatically

3 - Encrypting Data
  - Defending against man in the middle
    - The best way to defend is to encrypt data in flight
  - Using SSL\TLS
  - The benefit here is that a secret key is needed to read or alter a request or response
  - Certificates identify domains and require domain validation
    - This is to prove you have control over a domain
    - This can be adding an entry to a DNS table
    - This can be applicable to hiring a new employee and they need credential
  - Some types of enhanced validation may need government id (Up to the issuer)
    - This is where the green address bar is seen in the address bar
    - These are supposed to ask for a government id
  
  
  
                    Section 7 - HTTPS
1 - Introducing HTTPS
  - The percentage of the web using using HTTPS has increased steadly
  - A brief run through of the path to HTTPS 

2 - HTTPS & Cryptography
  - In order to communicate securely there are 2 types of encryption to be dealt with
  - Symmetric Encryption and Public Key Encryption
    - Symmetric Encryption is very fast much faster than Public Key
    - There is also no practical limit on content size
      - This is probably what most people who have locked a file with a password have used
  - If an encryption key was generated on a per-connection basis this would be almost perfect except for a catch on how to shear keys safely
    - Reusing keys is not good in cryptography as randomness is good
  - This is where Public Key cryptography comes in
    - There are 2 different types of keys Public and Private
    - The public key is used to create messages that are encrypted, the private kay decrypts them
    - The algoritms involved are very complex
  - Public Key Encryption, The key Exchange
    - This can be slow but is necessary for a system that is getting encrypted messages without divulging how to send them
    - The server sends it public key and certificate to the client
    - The client and server compare cipher suites
      - Cypher suites are essentially the methodologies used for the faster symmetric encryption used later
    - Finally a seesion key is generated be the client
      - This is encrypted with the servers public key so that only the server can read it
    - The session key is what is used for encrypted data exchange
  - Public keys are for writing messages
  - Private keys are for reading messages
  - The RSA algorithm is generated by the product of 2 huge prime numbers
  - Because of the size of the math involved there is a limit on the size of a message
  - Private keys can be use to sign messages

3 - TLS Handshake
  - Using chat bubbles to demo the TLS handshake
    - Client --
      - Hey I wish to communicate securely and understand ciphers
        - The certificate check out so this must be you
          - I too will be encrypting all my messages from now on  
    - Server --
      - Hey here is my certificate to prove my id, it is signed by someone you trust and here is my public key so you can send me stuff secretly
          - I will be encrypting all my messages from now on      

4 - OpenSSL
  - This is the industry standard library for cryptography
  - DO NOT implement your own algorithm, protocol or handshake etc
  - OpenSSL is not that user friendly
  - It will not be needed all that often
  - This is a cli tool, there is no relly good GUI tools available
    - Commands Example
      - Generate a private key
        - openssl gen rsa -aes128 -out my-private.key 2048
      - Generate a public key from a private key
        - openssl rsa -pubout -in my-private.key -out my-public.key
      - Make a new certificate signing request
        - openssl req -new -key my-private.key -out my-request.csr
      - Sign the certificate with a private key
        - openssl x509 -req -days 3 -in my-request.csr -signkey my-private.key -out my-certificate.crt

5 - Challenge 9: Defend Against Man-in-the-Middle Attack
  - The challenges are
    - Generate a RSA private/public key pair that is valid for 1 day
    - Use the Node JS HTTPS module to serve the example app over HTTPS
      - There is an existing HTTP module which needs to be swapped out
    - Add the certificate to the OS trust store (for Win/Mac OSX users)


