                    70-697 - Configuring Windows Devices
                    Course Notes


                    Course 01 - Whatâ€™s New in Windows 10
Windows 10 Differs from its predecessors in some ways
  - Not only a new revision of the operating system
  - Created to span a wide range of devices
  - The final evolution of the Start Experience
  - The culmination of the good features of Windows 8, 8.1, and Windows 7
  - A new updates model
  - Quite possibly the last major Windows release that we will see

The new updates model that Windows uses is a concept of Continuous Improvement
  - New features are delivered through Windows update as opposed to being set aside until the next major release
    - Fast Ring
    - Slow Ring
    - Current Branch
  More information on Slow and Fast rings is available here
    - https://www.neowin.net/news/windows-10-slow-ring-or-fast-ring-most-users-go-slow
    - https://www.neowin.net/news/microsoft-introduces-faster-build-release-cadence-with-windows-10-build-9860
This is similar to the rolling release model used by some Linux distributions

Windows 10 Home version does not support
   - Domain Join, Group Policy Management, BitLocker, Assigned Access, Remote Desktop, Client Hyper-V, AppLocker, BranchCache,
     DirectAccess, Enterprise Data Protection, Credential and Device Guard

The primary navigation difference in Windows 10 is the addition of a modified Start Menu incorporating the Windows 7
menu and the Windows 8 and 8.1 Start screen tiles
Besides the changes to the start menu there are changes to the desktop
  - Snap features have been improved which allows for better desktop organisation
  - Tablet Mode
  - Task view which has the ability to create multiple virtual desktops
  - Pinned items to both the Task Bar and Start Menu
  - Enhanced Notifications area

Windows 10 also has had Cortana a personal assistant added to it
  - It combines local and web searches
  - Cortana understands spoken commands
  - It has the intelligence to convert commands into tasks and appointments
  - This was originally on Windows Phone but has been carried over

                    
                    Course 02 - Windows 10 Deployment 
When installing Windows 10 the initial choice is which edition is to be installed as there are 4 versions each in x86\64
  - Home
  - Professional
  - Enterprise
  - Education
Using x64 is what most modern systems will use and the benefits of using a 64 bit platform include
  - Improved performance
  - Larger memory availability
  - Improved device support
  - Support for client Hyper-V
There are many factors that will need to be considered in choosing whether to use x86 or 64
  - 64-bit operating system requires a 64-bit compatible CPU
  - Installing a 32-bit version of Windows on a 64-bit CPU is possible but does not take advantage of the additional features.
  - 32-bit drivers will not work on a 64-bit version so hardware must come with 64-bit drivers in order to use a 64-bit 
    version of Windows
  - 32-bit applications are supported on 64-bit versions
  - If application support becomes a problem 64-bit systems can run client Hyper-V             

Preparing for installing Windows
Prior to installing Windows 10 you must ensure that your computers meet specific requirements in order to ensure successful 
deployment and ongoing use!
Hardware Requirements for installing Windows 10 are
  - 1 GHz CPU (x86 or x64)
  - 1 GB of RAM (x86) or 2 GB of RAM (x64)
  - 16 GB hard disk space (x86) or 20 GB (x64)
  - DirectX 9 graphics drivers with WDDM 1.0 or higher driver
There are also some additional oprtions which need to be met
  - BIOS based on Unified Extensible Firmware Interface (UEFI)
  - x64 CPU architecture that supports SLAT for Client Hyper-V
  - Trusted Platform Module for BitLocker
Ensure compatibility with Windows 10 for all devices on the system and check for the existence of device drivers
Device drivers
  - Are critical for system stability
  - There are tens of thousands of drivers already included in Windows 10
  - Additional drivers the maybe needed can be added at installation
  - There are a couple of considerations to be kept in mind
    - Windows 10 requires digitally signed drivers which increase security
    - 32 bit and 64 bit architecture use different drivers
Compatability considerations
  - The hardware center can check hardware compatibility for all devices and applications
  - Some standard application compatibility problems include
    - Setup and installation
    - User account control
    - x64 architecture
    - Operating system version changes
    - Removed or deprecated components
If you are using Windows 10 in enterprise environments you can use the Application Compatibility Toolkit (ACT) to identify and
resolve application compatibility issues
  - Verify application, device and computer compatibility centrally
  - Verify the compatability of Windows update
  - Mitigate any compatability issues
    - Modifying configuration of existing applications
    - When applying updates and/or service packs
    - Upgrading applications to a compatible version
    - Modifying security configurations
    - Using compatibility features or client Hyper-V

Installation Options
In Windows 10 environments of all type administrators have multiple installation types
The choice made will boil down to scenario and preferences of the administrator
The install options are
  - Clean
    - There is no OS on the hard disk
    - Run setup.exe from a network share or removable media
    - Images are also considered clean installations
  - Upgrade 
    - Replaces current version of Windows with Windows 10
    - In-place upgrade retains applications, settings, and data
    - Available from Windows 7, Windows 8, and Windows 8.1
  - Migrate
    - Performs a clean installation after backing up user data and settings
    - User settings are migrated to the new OS
  - Manual Installation
    - Run the setup from the DVD
      - Requires local interaction
      - Cannot be automated
    - Run the setup from a network share
      - Access from current operating system or Windows PE
      - Requires local interaction
    - Install from image
      - Additional planning is required
      - Can install Windows and applications
      - It utilises multiple components
  


                    Course 03 - Deploying Virtual Windows 10 Desktops
Windows 10 has made the server virtualization product Hyper-V available for client operating systems running Windows Pro
and Enterprise versions
Some of the features of Hyper-V are
  - Ability to run multiple virtual machines
  - Provides test environments
  - Provide application compatibility
  - Compatibility with Windows Server Hyper-V
  - Support for 64-bit guest operating systems
  - No application virtualization 
There are minimum requirements to be met to run Hyper-V
  - Pro or Enterprise versions of Windows 10
  - 64-bit version
  - SLAT (Second Level Address Translation)supported CPU
    - More information on SLAT is available at
      - https://en.wikipedia.org/wiki/Second_Level_Address_Translation
  - 4 GB of RAM
Tools included are
  - Hyper-V Manager
  - Hyper-V Virtual Machine Connection Tool
  - Hyper-V Module for PowerShe
Creating a virtual machine is relatively straightforward
  - Performed using a wizard or Windows PowerShell
  - Virtual Machine Name
  - Virtual Machine location
  - Memory
  - Network Connection
  - Virtual Hard-disk location
  - OS Installation media
They can also be configured to use
  - Automatic Start and Stop Actions
  - Integration Services
You can also import and export virtual machines to and from other hosts
Virtual Machine Storage
  - Virtual Hard Disks(VHD's) provide storage for a virtual machine
    - Inside the virtual machine VHD's look like physical HArd Disks
    - All data stored in a single file
    - There are 2 controller options IDE & SCSI
  - Checkpoints
    - These are point in time copies of the virtual machine
    - They have no effect on the state of the VM
    - There are a series of steps used to create a checkpoint
      - Pause the VM
      - Create a differencing disk
      - Make a copy of the configuration file
      - Resume the running VM
      - Save the contents to disk


                    
                    Course 04 - Configuring Device Settings
Windows 10 provides tools for confiuring for every user and multiple scenarios
  - The settings app is continually enhanced providing access to the most common settings required by end users
  - The Control Panel provides additional advanced configuration options 
  - Microsoft Management Console administrative snap-ins provide advanced configurations
  - Windows PowerShell provides command line administration 

Some of the advanced configuration tools include
  - Computer Management
  - Event Viewer
  - Performance Monitor
  - Resource Monitor
  - Task Manager
  - Disk Defragmenter
  - Registry Editor
  - Windows Firewall with Advanced Security
  - Device Manager

For more common configuration options
  -  In Windows 10 virtually all common configuration options will be found in the Settings app and searchable using Cortana
  - The Settings app is divided into sections to provide ease of use and has a built in search function 
  - Since this is a new and enhanced app you need to be familiar with where options are located in order to assist users

Common Configuration Tools
  - System
    - Display
    - Notifications and Actions
    - Apps and Features
    - Multi-tasking
    - Tablet Mode
    - Power and Sleep
    - Storage
    - Offline maps
    - Default apps
    - About 
  - Devices
    - Printers and Scanners
    - Connected Devices
    - Mouse & Touchpad
    - Typing
    - Autoplay
  - Network & Internet
    - Data Usage
    - VPN
    - Dial-Up
    - Ethernet
    - Proxy
  - Personalisation
    - Background
    - Colours
    - Lock Screen
    - Themes 
    - Start
  - Accounts
    - Your account
    - Sign in options
    - Work Access
    - Family & other users
    - Sync your settings
  - Time & Language
    - Date & Time
    - Region & Language
    - Speech
  - Ease of Access
    - Accessibility controls
  - Privacy
  - Update & Security
    - Windows Update
    - Windows Recovery
    - Backup
    - Restoration
    - Activation

Managing user accounts varies greatly and depends on what environment you working in
Home & Small Business Environments
  - Use two types of accounts locally
    - Standard
    - Use Microsoft accounts to provide additional synchronization options
  - Use Microsoft accounts to provide additional synchronization options
Enterprise Environments
  - Use domain accounts in Active Directory Directory Services
  - Use accounts in Azure AD
  - Can be linked to MS accounts
Accounts are created on or after installation and can be modified using the Settings app
  - Link an MS account
  - Link additional accounts
  - Setup Family or other User accounts
    - Manage family settings online
  - Setup assigned access
    - User has limited access to apps on the PC as defined by the administrator
Local Accounts can also be synchronized using a Microsoft account 
  - This provides access to cloud based services and synchronization of settings across multiple computers
  - Can be used to sign in to a Windows 10 computer
  - Required for accessing several apps
    - One Drive
    - Mail
    - Calendar
    - Outlook.com
    - XBOX Live
  - Typically only used in smaller environments
Domain based environments and user accounts provide multiple benefits 
  - Better scalability
  - Centralized administration
  - Delegation of control
  - Better control and event logging
  - Centralized configuration management using Group Policy
  - Single Sign On (SSO) access to resources


                    
                    Course 05 - Connecting Windows 10 to Networks
TCP\IP Connectivity
  - In Windows 10 as on the internet TCP\IP will be the default protocol
  - Knowledge of both IPv4 and v6 fundamentals are needed by an IT professional
  - There is basic configuration information needed in order to connect to networks
    - IP Addresss
    - Subnet Mask
    - Default Gateway
    - DNS Server
    
A full discussion on Networking an IP Addressing is available at 
  - https://github.com/marb61a/Course-Notes/blob/master/Networking/Network%2B

LAN's are configured using two main scenarios
  - Simple IP Configuration
    - Uses private address spaces
    - Uses default subnet masks
    - Provides various network sizes
    - Requires Network Address Translation (NAT)
  - Advanced IP Configuration
    - Public or private address spaces
    - Variable Length Subnet Masking 
    - Classless Inter Domain Routing (CIDR)
      - A way to allow more flexible allocation of IP addresses than was possible with the original system of IP address classes
      - More information at -- http://searchnetworking.techtarget.com/definition/CIDR
IPv4 Connectivity is configured using
  - Network & Internet in the Settings App
  - Network & Sharing Center
  - Windows Powershell
  - Can be configured automatically as well as manually

When connecting to a network for the first time you will be asked to specify the network type
  - Home 
  - Work
  - Public
This configuration is remembered in the Network and SHaring center which will also
  - Control App behaviour
  - Will controle the firewall rules both inbound and outbound
  - You can also configure attached printers based on network location
  
IPv6 is the next generation of TCP/IP developed to fix many issues realized in IPv4
  - It has a much larger address space
  - Hierarchical routing and addressing
  - Stateless and stateful automatic configuration
  - Required support for QoS and IPSec
  - Reduces the need for NAT in many cases
Windows 10 has full support for IPv6
  - It is installed by default
  - It has both v4 & v6 which is called a dual stack architecture
  - Some feature require v6
  - Windows Services use IPv6

                    
                    Course 06 - Sharing Data and Printers
Managing Harddrives
  - In Windows 10 things are much simpler for managing drives in the local system as there are more options available
  - System Administrators will need to understand
    - Different types of partitions and volumes
    - How to create these partitions and volumes 
    - How to perform disk maintenance
    - How to troubleshoot disks
    - How to work with virtual hard drives
    - Situations requiring multiple disks
Partitions
  - Master Boot Record (MBR)
    - The MBR is created on the first sector of the disk
    - It lists the sizes and the locations of partitions
    - It is limited to 4 partitions
    - 2TB maximum partition size
    - No Redundancy
  - GUID Partition Table (GPT)
    - The disk contains an array of partition entries
    - Each partition is identified by a GUID
    - Up to 128 partitions per disk
    - There is a maximum volume size of 18EB
    - CRC used for redundancy
Disk Management Tools
  - Storage in the Settings App
    - Identify the storage use
    - Clean Up disks
    - Configure the default save locations
  - Disk Management
    - Advanced Disk Management
  - Diskpart and Windows Powershell
  - Storage Spaces in the Control Panel
You can convert disk from MBR to GPT
  - The System partition must be MBR in BIOS systems
  - UEFI systems only support booting to GPT
  - GPT is supported for data disks
  - Only use GPT if you need partitions greater than 2TB
  - There are things that must be considered
    - Administrator or Backup Operators
    - Always backup data first
    - Disks must be online
    - One way conversion unless you wipe the data
MBR Disks are either Basic or Dynamic, Dynamic provides additional functionality such as
  - The ability to be extended
  - Creation of multiple volume types
  - Mirrored Volumes can be repaired
  - Missing or Offline disks can be reactivated
  - There are no limits on the amount of volumes that can be created
Volume Types
  - Simple
    - This is a contiguous space on a hard drive
    - There is no fault tolerance
    - Offers no increases in performance
    - This type of volume can be extended using unallocated space
    - The conversion to dynamic is performed automatically
  - Spanned
    - Constructed using space from multiple dynamic disks
    - Like simple offers no performance improvement
    - Also like simple there is no fault tolerance
    - These volumes can be shrunk or extended
  - Striped(RAID-0)
    - This uses identical allocated space from 3 or more disks
    - There is a faster throughput of data
    - There is no fault tolerance
    - These volumes cannot be extended or resized
  - Mirrored
    - Uses two identical dynamic disks
    - Duplicates data across both disks
    - There is fault tolerance
    - These volumes provide enhanced read access
Drive Letters and Mount Points
  - Each volume is formatted using a file system
  - In Windows Drive Letters are provided for access
  - Using mount points will provide more flexibility
  

                    
                    Course 07 - Managing Apps
Installing and Configuring Applications
  - Applications are the primary tools that users rely upon in order to perform their work on a daily basis
  - In order for users to be successful, applications must be
    - Installed and available
    - Configured Properly
    - Customisable
  - Windows 10 has 2 types of application
    - Desktop Apps
    - Modern Apps
    
  - Applications are installed in a number of different ways
    - Manual Installation
      - Removable Media
      - Network Sharing
    - Automated Installation
      - Logon Scripts
      - Group Policy
      - SCCM
  - Program installation will require administrative permissions
  - Installing applications may cause consent being sought for User Access Control (UAC)
  
  - In Windows 10 there are different types of customisation for users in relation to applications
    - Configuring Default Programs in Settings or Control Panel
      - Set the program as the default
      - Choose defaults for a program
      - Associate file types with a new program
      - Change AutoPlay settings
      - Set program access and computer defaults
    - Customising Start Menu
      - Rearrange
      - Pin items to start menu or taskbar
  
Managing Apps from the App Store
  - The Windows Store
    - A convenient single location to find and download apps
    - Access without using Control Panel using Start menu
    - Requires the use of a Microsoft account
  - Modern Apps
    - They are distinct from desktop apps
    - Now resizable and visible beside desktop apps
    - Compatible acrodd multipl platforms
    - Accesible via search on the Start menu
    - Installable with a single click
    - Share with up to 5 different devices
    

                    
                    Course 08 - Securing Windows 10 Devices
Security in any organisation is the responsibility of everyone in the organisation
To work with security it is necessary that you first understand
  - Vulnerabilities
  - Threats
  - Mitigation techniques
After these then you must proceed with a plan of action

A more generalised approach to security is called Defence In Depth
  - Involves applying multiple levels of security
  - It guards against malicious users that breach one or more levels of security

Some of the likely scenarios to occur
  - An unauthorized user accessing information on a file server
    - Apply permissions to files and folders
    - Implement file and folder level encryption
    - Utilize AD RMS
  - Unauthorized user accessing information from a stolen or lost flash drive
    - BitLocker to Go
    - Utilize AD RMS
    - Implement application based encryption or password protection
  - Lost or stolen laptop
    - BitLocker

Configuring Local Security
  - Local security policies are used in Windows 10 to mitigate security risks
    - Unauthorized logons
    - Improper network access
    - Unauthorized maintenance
  - Security policies can be configured locally or via Group Policy in Active
    - Directory Domain Services
  - Local policies in conflict with domain policies are overridden

User Account Control(UAC) feature of Windows that provides protection against unwanted software
  - It prompts a user for administrative credentials or consent
    - Running installation programs
    - Modifying Windows settings
  - It helps protect againt background unkown installation of software
  - Provides limited prompts in comparison with previous versions
    - The following are done without prompting in Windows 10
      - Updates
      - Driver installation
      - Viewing Windows settings
      - Resetting network adapters
UAC does prompt the following in Windows 10
  - Credentials Prompt
  - Consent Prompt
There are also some elevation prompts used
  - A setting or feature part of Windows needs permission to start
  - A program that is not part of Windows needs permission to start
  - A program with an unknown publisher needs permission to start
UAC Has notifications whose settings are
  - Never Notify
  - Notify only when apps try to make changes without dimming desktop
  - Notify only when apps try to make changes
  - Always Notify
UAC can be configured via 2 options
  - Control Panel -> Basic Configuration
  - GPO's -> Advanced Configuration

There are many different types of malware
  - Virus, Worm, Trojan Horse, Macros, Spyware, Adware etc
  - The best protection against all of these is to have fully installed, configued and updated anti-malware systems
Windows 10 uses Windows Defender by default to provide anti-malware capabilities
  - It is installed and enabled by default
  - It automatically protects a system by scheduled scans
  - It provides responses that can be configured based on severity levels
  - It uses Windows Update for spyware and virus definition updates
  - It also provide addition custonisation options


                    
                    Course 09 - Monitoring and Maintaining Windows 10
Working with Updates
  - Windows Update is a service which provides critical updates to both the OS and running applications
    - Hot fixes
    - Critical Security Patches
    - Operating System Updates
    - Applications Patches
    - Service Packs
  - The automatic update client ensures the application of updates
The Management of Updates
  - This has been moved to the settings tab
  - The updates and security tab
  - Options available include
    - Automatic 
    - Notify
    - View Update History
    - Remove Updates
Enterprise environments using Windows will use Group Policy Objects to configure options
  - Automatic Update Options
    - Install automatically
    - Download Automatically and choose when to install
    - Check for updates and notify for install
    - Never check for updates
  - Configure intranet update service location
  - Power management options
  - Restart Options
  - Notification Options

Monitoring and Optimising
  - Users require high performance of the OS and hardware to acheive their goals
    - Performance is a measure of system responsiveness
    - Administraton must ensure that performance levels are maintained or improved
  - The monitoring of subsystems is beneficial
    - CPU\Processor
    - Memory 
    - Disk
    - Network
Performance Monitor
  - Is an advanced administrative tool
  - It is capable of both real-time and scheduled monitoring
  - It gives detailed information on system performance
Data Collector Sets are the building blocks of performance monitoring and reporting in Windows Performance Monitor
  - It is a manageable object providing scheduled monitoring and reporting
    - Performance Counters
    - System Configuration
    - Event Trace Data
    - Alerts

                    
                    Course 10 - Managing Users in the Enterprise
Managing User Profiles
  - In Windows OS every user must have an account, which comes with a local profile
  - This is stored in the C:\Users directory
  - It provides unique setiings for each account that is persistant
    - Registry Settings
    - Application Configuration
    - Various Directories
  
4 Different types of profile
  - Local
    - This is the default type created the first time a user logs in
    - A copy of the hidden Default profile
  - Roaming 
    - Stores the entire user profile in a network location
    - Configuration on the user account properties in Active Directory
  - Mandatory
    - User cahnge made to local copy are not preserved after logging out
    - Ntuser.dat is renamed to ntuser.man
  - Super Mandatory
    - Rename the folder to USerName.man
    - Require the server to available or login is denied
 
 There is an alternative to roaming and mandatory profiles which is Folder Redirection in Group Policy
  - Redirects folders from local location to a network location
  - Does not copy folders down to the client
  - Eliminates some issues with roaming profiles while still providing advantages
  - Offline features provide access when network connectivity is lost
  - Additional features are available
    - Redirecting to multiple locations
    - Redirecting to home directories
    - Take advantage of folder permissions and quotas
    - Provide centralized backups

The Primary Computer Setting
  - Provide control over which computers receive a copy of the roaming profile and which folders can access redirected folders
  - Requires Windows Server 2012 AD schema
  - It is configured using the  msDS-PrimaryComputer user attribute using Active Directory Admin Center or Windows PowerShell
  - The following Attribute Configuration use the Group Policy settings
    - Redirect folders on primary computers only
    - Download roaming folders on primary computers only

                    
                    Course 11 - Managing Desktops and Applications in the Enterprise 
Using Group Policy to manage Windows 10 devices
Group Policy is a configuration management technology implemented in Active Directory networks providing numerous benefits
  - Centralised Administration covering
    - Desktop environments
    - Data access
    - Restricted Applications
    - Security Controls
  - Lowers the Total Cost of Ownership
  - It also provides decentralised controls
Types of policies
  - Settings
    - Mandatory Configurations
    - Users are unable to change
    - Do not persist if policy is removed
  - Preferences
    - Non-mandatory configurations
    - User interface is not disabled
    - Persist if the policy is removed
  - Policy settings apply to
    - Users
    - Computers
  - Most settings are found under either computer configuration or user configuration but not both
  - Settings for the computer effect any user that logs on to the computer
Local Group Policies can be used to provide a high level of customisation in local security
  - It is used in special scenarios and workgoups
  - It can be overrriden by domain based GPO's
  - Local security settings
    - secpool.msc
  - Local Group Policy Editor
    - gpedit.msc
  - Multiple local GPO's
    - Group Policy Object Editor MMC snap-in
Group Policy is implemented through Group Policy Objects (GPOs)
  - It is applied using the Active Directory logical hierarchy
    - Sites
    - Domains
    - Organisational Units
  - Configure settings for users and computers based on location
  - It is automatically applied at logon and startup
  - Updated automatically through a periodic refresh
  - It can be updated manually
    - gpupdate.exe
    - Invoke-GPUpdate
  
                    
                    Course 12 - Managing Devices in the Enterprise
The Enterprise Mobility Suite is
  - A set of technologies intended to address modern enterprise needs
It provides
  - Management
  - Deployment
  - Device Protection
  - Application Mangagement
  - Data Control
It requires the following to function properly
  - Azure Active Directory Premium
    - Windows Server 2003 or later forest functional level
    - Windows Server 2008 SP1 or later
    - This is an online directory service used in certain scenarios
    - It provides identity as a service with the need to bild the infrastructure
    - It Supports
      - Cloud based applications for internal users
      - Cloud based and on-premises applications for internal users
      - Cloud based applications that third party vendors provide
    - Some benefits are
      - Provides group management in addition to user management
      - Provides self-service password reset
      - It also provides multi-factor identification
    - Using Windows 10 with Azure Active Directory Premium
      - Join computers with Windows 10 installed to AD
      - OS roaming
      - Signing in using Azure AD accounts
      - Use SSO for cloud based SaaS
      - Automatic enrollment for MDM solutions
  - Azure RMS
    - This helps organisations prevent data leakage by providing information protection technology
    - Windows 7 or later
    - Mac OS X 10.8 or later
    - Office 2010 or later
  - Intune
    - Communication over ports 80 and 443
