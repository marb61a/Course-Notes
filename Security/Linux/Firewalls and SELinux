                    Firewalls and SELinux
                    Course Notes


                    Section 1 - Introduction 
1 - Welcome to firewalls and SELinux 
Brief intro to the course and the author

2 - Prerequisites 
There are some pre-requisites
  - Use a test system or vm
  - Do not use a live system
  - Have some experience with Linux
  - The course uses Fedora 25 as its distro



                    Section 2 - Firewall Basics on Linux 
1 - Iptables and Firewalld 
Firewalls can be complex and complicated
  - On the Fedora distro being used this is even more true
  - This is because of the fact that there are many open sources add-ons
  - Some of these directly interact with the kernel
  - Firewalls will use Netfilter which is in the core of the networking system
    - Netfilter cannot be directly configured, tools are needed
  - There are 2 different conflicting tools available IPTables and Firewalld
IPTables
  - This has been in existence longer
  - It may become deprecated
Firewalld
  - Is newer and runs on the basis of a different security metaphor
  - It is also thought of as being easier to configure
These 2 systems cannot work together on the same system at the same time
  - There are some mutual exclusion rules which need to be added and are covereed by the course
Example Syntax
  // To see if IPTables is running on the system
  $ sudo -s                                 // This enters the system into an elevated privilige (sudo) session
  # systemctl status iptables               // This checks whether IPTables is running, the hash symbol indicates a root user
  # ls -Fla iptables                        // This will show more detailed information about whether IPTable is installed
  # systemctl mask iptables                 // IPTables will need to be masked out to prevent it running by itself 
  
  # systemctl stop iptables                 // Some systems will have IPTables running so this stops it

2 - Installing Firewalld 
To ensure that you have it Firewalld installed
On Fedora Systems
  - dnf install firewalld
  - dnf has replaced yum as package manager since Fedora 22
  - firewalld is written in Python

3 - Installing the Firewalld GUI controls 
To run the firewalld gui
  - # firewall-config
  - This might need packages to be installed
    - There will be a demo on systems both with and without GUI
    - The firewall-config utility is not installed by default

4 - Installing GUI controls with no GUI 
To install the firewall-config utility from the terminal
  - dnf install firewall-config

5 - Understand Firewalld zones 
Zones will need to be properly understood in order to correctly configure the service
  - A zone defines the level of trust for network connections
  - These are one to many relations
  - A connection can only be part of one zone
  - One zone can be used for multiple connections
To get a list of supported zones from firewalld at the terminal
  - firewall-cmd --get-zones
To see which have enabled features
  - firewall-cmd --list-all-zones

6 - Understand Firewalld services 

7 - Zones explored 



                    Section 3 - Configuring Firewalld for Local Protection 
1 - Firewall-cmd configuration preparation 

2 - Allowing the Apache web server 

3 - Allowing any mail server 

4 - Allowing an XMPP server 

5 - Allowing an SMB server 

6 - Allowing an NFS server 

7 - Allowing an LDAP server 

8 - Allowing a PostgreSQL server 

9 - Allowing FTP and SFTP servers 

10 - VM Port Forwarding 

11 - ShieldsUP! panic mode 


                    Section 4 - SELinux Fundamentals 
1 - Installing SELinux utils 

2 - Discretionary vs. mandatory access 

3 - Understanding contexts 

4 - Installing SELinux man pages 

5 - Understanding Booleans 



                    Section 5 - Working with SELinux 
1 - Enabling SELinux and modes 

2 - Graphical management tools 

3 - Changing context labels 

4 - Changing ports on services 

5 - Copying files 

6 - Moving files 



                    Section 6 - SELinux Troubleshooting 
1 - Running sepolicy 

2 - Finding SELinux logs 

3 - Making domains permissive 

4 - Disabling and reenabling SELinux 



                    Section 7 - Conclusion 
1 - Next steps 

