                    Network Pentesting -- Notes

                    Section 1 - Introduction
1 - Course Introduction
Network pentesting is a huge field
A description of the topics to be covered in the course
  - Information Gathering -- OSINT, DNS, SNMP etc
  - Pentesting network components -- Routers, Switches, Firewalls, IDS\IPS
  - Pentesting Windows Environments -- Domain Controllers, Active Directory etc
  - Pentesting Linux environments
  - Pentesting Mobile Application backends
  - Attacing via DMZ, web email etc
  - Post Exploitation on Windows, Linux, Mobile
  - Data Exfiltration tools and techniques
  - Privilege escalation on Windows and Linux
  - Keeping access -- Rootkits and Backdoors
  - Web application vulnerability to shell
  - Scenario based pentesting
  - Social Engineering attacks
  - AV evasion techniques
  - Firewall and IDS evasion

                    
                    Section 2 - Pentesting Routers 
1 - Setting up the lab
Vulnerabilities can be divided into 
Software vulnerabilities
  - These are rare and are usually patched quickly
  - Exploit Reseacrh is the field which finds and exploits vulnerabilities
Faulty by Design	
  - Diﬃcult	to ﬁnd for mature	products	
  – Reversing	ﬁrmware	images and tesing
Configuration Flaws
  - These can be very common
  - Are only as secure as the knowledge of the team implementing them
  
Configuration flaws can be further sub-divided in to
  - Attacking Administrative Services
    - SSH
    - Telnet
    - HTTPD
    - SNMP
  - Routing Attacks
    - RIP
    - OSPF
    - BGP
The software used for demonstration is Vyatta
  - The company was taken over by Brocade so software is not available
  - There was a community based for of the Vyatta OS which is available at -- https://vyos.io
  - The latest downloads are available at -- http://packages.vyos.net/iso/release/1.1.7/
  - The files are both in ISO format and OVA format

2 - Default Credentials


3 - Attacking SSH with Metasploit

4 - Attacking SNMP with NMap & Metasploit

5 - Attacking Web Interface

6 - SNMP Post Exploitation

7 - SNMP Audit with Metasploit with SNMPCheck

8 - Nmap NSE


                    Section 3 Pentesting Windows
1 - Pentesting Windows Environments Study Plan
The Windows Universe which will be part of the course consists of
  - Endpoints such as Laptops, Workstations & Phones
  - Servers such as Web Servers and other services
  - Enterprise Environments covering Domain Controllers, Active Directory etc
  
The Windows section of the course will cover penetrating systems through
  - Software Bugs
    - Core Windows system
    - 3rd Party Software
  - Software Misconfiguration
  - Social Engineering

Lab setup
  - Ensure Proper Licensing for your Windows installation
  - Setting up your own lab allows you to learn to both create and fix vulnerabilities

2 - Pentesting Windows Endpoints Exploiting Software Vulnerabilities
The course will covers software based vulnerabilities
It is recommened that students are familiar with the Metasploit framework
Home Lab should be setup
  - Metasploit & Kali Linux attacker
  - Windows 7 with Bad Blue Enterprise edition server installed
    - Bad Blue is known to have buffer overflow vulnerability 
    - Install vulnerability at -- http://www.exploit-db.com/exploits/16806/	
    - Structured Exection Handling (SEH)
      - Tutorial at -- http://www.primalsecurity.net/0x3-exploit-tutorial-buffer-overflow-seh-bypass/
    - Pop Pop Return (PPR)
      - Tutorial at -- http://www.securitysift.com/windows-exploit-development-part-6-seh-exploits/
      

3 - Pentesting Windows Endpoints Exploiting Software Misconfiguations
Showing how to break into Windows systems using Windows misconfigurations
The service is a very common one - RDP
  - Remote Desktop Protocol (RDP) is a proprietary protocol developed by Microsoft, which provides a user with a graphical
  interface to connect to another computer over a network connection.
There are different misconfigurations possible for RDP
  - Allowing RDP for all accounts
    - Weak Username & Password for even a single account
  - No Account Lockout Policy
    - A lot of organisations mistakenly do not apply this policy
  - Using the default RDP port (3389)
    - Use different ports if possible
    - Have an accepatable IP Range

NMap Demonstration
Scan Syntax
  - nmap -sV -p3389 -n 192.168.1.8
  - RDP marked as ms-wbt-server in the command output

Ncrack
  - https://nmap.org/ncrack/
  - Used for network authentication cracking
Demo Syntax
  - ncrack -U rdp_user_list -P rdp_pass_list -p rdp 192.168.1.8
  - You can create your own password list

4 - Pentesting Windows Endpoints Social Engineering

5 - Pentesting Windows Endpoints Firewall Bypass Reverse Shell

6 - Pentesting Windows Endpoints HTTP Tunnelling Payload

7 - Pentesting Windows Endpoints Automatic Outbound Open Port

8 - Pentesting Windows Endpoints Port Forwarding

9 - Pentesting Windows Endpoints Pivoting

10 - Pentesting Windows Endpoints Reverse Connects Through Pivots

11 - Pentesting Windows Endpoints AV Bypass Python

12 - Pentesting Windows Endpoints Windows 7 Pivilege Escalation UAC Bypass

13 - Pentesting Windows Endpoints Windows 7 Hash Dumping


