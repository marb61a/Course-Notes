                    Web Application Pentesting - Course Notes
                    
                    
1 - Course Introduction
There will be material for begginer, intermediate and advanced topics
Course will cover
  - HTTP\HTTPS protocol basics
  - Understanding Web Application rcitectures
  - Lab setup and tools of the trade
  - Converting your browser into an attack platform
  - Traffic interception and modification using proxies
  - Cross Site Scripting
    - Types
      - Reflected
      - Persistent
      - DOM Based
    - Filtering XSS
    - Evading XSS Filters
    - Cookie Stealing and Session Hijacking
    - Self-XSS
    - BeeF
  - SQL Injection
    - Error Based
    - Blind
    - Second Order Injections
  - Broken Authentication and session management
    - Session ID Analysis
    - Custom Authentication
  - Security Misconfigurations
  - Cross Site Request Forgery
  - Insecure Cryptographic Storage
  - Clickjacking
  - And more....

2 - HTTP Basics
Hypertext Transfer Protocol (HTTP)
  - It is a Client-Server based architecture
  - It uses a Request-Response model to serve resources
  - Resources are identified by a Uniform Resource Identifier (URI)\Uniform Resource Locator (URL)
  - The main versions in use are HTTP1.0 & 1.1
    - 1.1	can reuse connection for multiple	URIs	  
  - A quick demonstration to show how HTTP process works by using curl
    - Curl is a command line tool for transferring data with URL's
    - It works with many protocols such as HTTP, HTTP/2, FTP among others
    - https://curl.haxx.se
    - curl -v url -- This will show verbose mode
      - This will show the HTML structure of the page div's etc
  - Example requires that curl, netcat and Wireshark be installed
    - Netcat (often abbreviated to nc) is a computer networking utility for reading from and writing to network connections
      - http://nc110.sourceforge.net
    - There is a cheet sheet for commands available at the following address
      - https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf
    - Wireshark is a network protocol analyser for both Windows and *nix based machines
      -https://www.wireshark.org
      - This means that you can examine network traffic at the packet level
      - 99% of websites use HTTP over TCP rather than UDP
  
  
3 - Netcat Lab
Full demonstration on using Netcat
Netcat is a replacement for Telnet
Syntax for connection to a site
  - nc www.google.com 80 -- This will connect to the google site on port 80 ()
    - Not advisable to do this with Google but the domain you are testing instead
Issue a HTTP request
  - GET /HTTP/1.0
  - Host www.google.com
You will get the HTML content of the page, the server will usually disconnect after completion
Using HTTP 1.1 will not disconnect
Using the Connection: close option will close the server connection


4 - HTTP Verb Tampering
HTTP Request methods are operations that can be run on resources on the server
  -  GET	
   – Parameters in URL	
  - POST	
   – Form	submissions, data	in message body	
  - OPTIONS	
   – List	of methods supported for URL	
  - HEAD	
   – Response	for	GET	but	no message	body	
  - TRACE	
   – Echo client request back	for	diagnosis	
  - PUT	
   – Store in URI	
  - DELETE	
   – Delete	resource	

5 - Verb Tampering with NMap
Metasploit has a module called Options, in order to use it at the Metasploic prompt type
  - use auxilliary/scanner/http/options
  - show options      -- This will show the HTTP options available
    - You will need to fill in RHOSTS IP Address
    - You can also set the port on RPORT
  - run               -- This will run the scanner
  - Options is use to enumerate the HTTP options available on a remote system
  - Sample scan shows POST, Options, GET and HEAD methos allowed

Using Options for Verb Tampering
  - use auxilliary/scanner/http/verb_auth_bypass
  - show options      -- This will show the HTTP tampering options available
  - run               -- This will run the scanner
 
Using NMap
  - Using Nmap nse scripts
  - Documentation available at -- https://nmap.org/nsedoc/scripts/http-methods.html
  - The script being used is called http-methods.nse
  - nmap --script=http-methods.nse 192.x.x.x -n -p 80
    - This gives Port, State and Service
  -  Retests may not be safe if there are DELTE methods

Using NMAp for Verb Tampering
  - The script being used is called http-method-tamper.nse
  - nmap --script=http-method-tamper.nse 192.x.x.x -n -p 80


6 - HTTP Verb Tampering Demo
Most web servers are no longer vulnerable to this attack
  - You may have to look at legacy systems or misconfigurations of software
There is a custom built site for demo purposes
The demo has a misconfigured .htaccess Apache server file
  Syntax
  AuthType Basic
  AuthName "Restricted Files"
  AuthUserFile "/etc/apache2/passwords"
  
  // Request method limitations means the verb tamper attacks can become applicable
  // Limitations in Apache .htaccess files are done with Limit tags
  // The below says to limit access to this resource via post only for valid users
  // This means that any other request method would be valid and would not require authentication
  // This misconfiguration is what leads to HTTP verb tamperiing
  <Limit POST>
    Require valid-user
  </limit>
Making a request via curl
  // Using POST instead of GET will cause an authentication error
  curl -v -X  GET http://192.168.1.11/secret
  
  
7 - Verb Tampering Lab Exercise
The solution is similar to the previous section
The demonstration system uses Tiny Core Linux

8 - HTTP Basic Authentication
A full list of HTTP Response Codes is available at
   - https://github.com/marb61a/Course-Notes/blob/master/Security/http%20status%20codes

At the protocol level there are only 2 types of authentication support
  - Basic Authentication
    - An indepth look at the Basic Authentication process is available at
      - https://docs.oracle.com/cd/E24191_01/common/tutorials/authn_http_basic.html
      - https://docs.oracle.com/cd/E39820_01/doc.11121/gateway_docs/content/authn_http_basic.html
  - Digest Authentication
Other authentication schemes such as Open ID are not part of the HTTP standard

There is a challenge application demo using Wireshark

9 - Attacking-Basic-Auth-Metasploit-Nmap
Demonstation an attack agains HTTP Basic Authentication using
  - Nmap and Metasploit

10 - 
