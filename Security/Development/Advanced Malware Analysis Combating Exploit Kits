                    Advanced Malware Analysis Combating Exploit Kits
                    Course Notes
                    
                    
                    Section 1 - Course Overview
1 - Course Overview
Introduction to the course author
Quick introduction to the course syllabus


                    Section 2 - Introduction
1 - Introduction to Malware
Discussion of the syllabus

2 - Demo: Analyzing a Bromium Alert
Demonstration using Bromium software
  - https://www.bromium.com
The demonstration will show Bromium from 3 different perspectives
  - End User
    - Your security software should typically be invisible
    - In Bromium each website or document is rendered inside a micro virtual machine
    - Bromium Live View will show list of micro vms
    - Bromium has 3 products
      - VSentry is the protection piece enabled by micro vms
      - Lava is the detection piece inside the micro vm
      - BEM is a detection piece for the host
  - SOC Operator
    - Bromium Enterprise Controller (BEC)
    - Data from Lava is sent to the BEC where a SOC analyst is likely to interact with it
  - Advanced Malware Analyst
    - BEC has dashboard for various areas
    - The Threat Behaviour Graph is the traditional BEC view of a Lava event  
      - Dropped and executed events are typically the most interesting
    - There are different files generated for a BEC alert
      - An xml file which is used to populate the BEC GUI
      - There is a proc-mon style database file which houses many of the events which took place in the micro vm
      - There is a malware manifest which includes the files that were touched, created and dropped
      - There is a set of sample Python scripts included 
        - In this example there is a script which runs against the database file and gives clearer information
          - In the example Word runs a command to start a batch script which is unusual
          - Executables deleting themselves is typical behaviour of malware covering its tracks
          - DNS is very useful especially if the sites are not familiar
          - Using micro vm trace information is an excellent way of finding relevent info about an attack
          - Being situationally aware of the threat type is very important
            - If a web page you would expect to see flash, images etc
          - Oledump shows malicious macros
            - http://www.decalage.info/python/olefileio
            - https://blog.didierstevens.com/programs/oledump-py/
      - Macro malware is once again a hot topic

There are both trusted and untrusted documents in the Bromium world, untrusted will render inside a micro vm while trusted
can be rendered outside a micro vm.
https://www.virustotal.com - Free service which uses over 50 anti-virus services to check files urls etc

3 - Security Tool Follow-up

4 - First Malware Analysis Lab


                    Section 3 - Recognising The Exploit Vector
1 - Recognizing Exploit Vector Intro

2 - How to Find the Exploit in a Malware Attack

3 - Exploit Finding Demo

4 - Exploit Finding Lab 



                    Section 4 - Unravelling Exploit Obfuscation
1 - Intro and Why to Script

2 - Continued Deobfuscation

3 - Deobfuscation Demo

4 - Deobfuscation Lab                  
                    
                    
                    
                    Section 5 - Circumventing Exploit Kit Encryption
1 - Module Overview and Homework Review

2 - Exploit Kit Details

3 - Deobfuscation

4 - Deobfuscation Lab 


                    Section 6 - Understand Moving Target Communications
1 - Module Goals and Assignment Review

2 - DGAs and More

3 - Non-DGA EKs

4 - Begining EK Detection Lab

                    
                    
                    Section 7 - Detecting Angler In The Wild
1 - How to Find More Samples

2 - Malware Detection

3 - YARA

4 - YARA Examples and Lab
                    
                    
                    
                    Section 8 - Performing Safe Dynamic Analysis
1 - Malware Analysis Goals

2 - Another Sample

3 - Dynamic Analysis Walk-through

4 - Sandbox Assignment


                    
                    Section 9 - Analysing Files Statically
1 - File Analysis Tools and Techniques

2 - Demo: How to Use the tools

3 - More Tool Details

4 - Assignment: Run and Report

                    
                    Section 10 - Reversing Malware With Debugging Tools
1 - Static or Dynamic Analysis?

2 - Demo: Extract Malware with IDA Debugger

3 - More on how to Choose an Approach

4 - Debug Details and Assignment


                    
                    Section 11 - Reversing Malware With IDA Pro
1 - Demo and Lesson Plan

2 - Reversing Demo

3 - Goals and Cyclic Recap

4 - Reversing Details and Assignment



                    Section 12 - Customising Reports From Researchers To CISO's
1 - Intro and Recap

2 - How to Report Treat Data

3 - Summary and Assignment
