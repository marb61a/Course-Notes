                    Network Penetration Testing and Ethical Hacking
                    Course Notes


                    Section 1 - Comprehensive Pen Test Planning, Scoping, and Recon
1 - Pen-Testing Foundations
Brief intro to the course and instructor
Getting this section learned properly will make a profoundly better pen-tester

2 - Pen-Testing Process
At the very highest level there are 3 main stages of a Pen Test
  - Preparation
    - If needed sign the Non-Disclosure Agreement (NDA)
      - This will change whether a 3rd party or in-house Pen-Tester
    - Discuss the nature of the test with target personnel
      - Agreement on Rules of Engagement
      - Determine clearly the scope of the test
      - Identify the most salient threats and any business concerns
    - Sign off on permission and notice of danger from testing
  - Testing 
    - Assign the team
    - Conduct the test
    - Perform detailed analysis and retest 
  - Conclusion
    - Reporting and a possible presentation
Permission Memo
  - It is vital that there be a digned memo or equivalent present giving permission to test
    - This should be as high in the organisation as possible eg CIO
  - This needs to be done prior to any test activity 
  - In industry parlance it is sometimes called the Get Out Of Jail Free Card
  - The course instructor makes a sample available on his site
    - This is suitable for an in-house Pen Tester
Limitation Of Liability and Insurance
  - The example premission memo from abaove is not suitable for use by third party Pen Testers
  - This requires a limitations of liability agreement and contractual language will be used
  - This document should be drawn up by a legal professional
  - The liability is commonly limited to not exceeding the value of the project
  - Most Pen Testing companies carry both Liability and Errors & Omissions Insurance
Follow The Law
  - Most countries have laws concerning crimes committed using computers
  - As Pen Testers adherence to the laws as carefully as possible is needed
  

3 - Reconaissance
During the reconnaisance phase an attacker will gather information from public sources to learn about the target
  - This usually covers the people, culture, terminology and technology infrastructure
For Pen-testing companies it is recommended that the team make at least 1 staff day available for reconnaissance
Skip tracing is the process of locating a person's whereabouts
  - There are electronic versions available such as -- www.makensi.es/stf/
Document Metadata
  - Most documents contain large amounts of metadata
  - Often this metadata is about how the formatting for display is done
  - Some of this may go a little further and give a pen-test some interesting tidbits
  - There is different types of information usually included in metadata
    - These include Usernames, File System Paths, E-Mail addresses, Client side software being used
    - There can be also information such as undo data or hidden and obscure fields
  - There are many different document types but certain types are more interesting
    - This list is not exhaustive
    - pdf, doc, dot, docx, xls, xlt, xlsx, ppt, pot, pptx, jpg, jpeg, html and htm
Useful Google Search Directives
  - The "intitle:" directive
    - This shows pages whose title matches the search
    - Example -- intitle:index.of passwd
      - This finds indexed web directories with the word 'passwd' in the listing
      - Directory indexing is enabled on some servers
  - The "inurl:" directive
    - This shows page whose Url matches the search criteria
    - Example -- inurl:viewtopic.php
      - This finds a script which is in phpBB which are script for running an online forum an have a history of issues


4 - Intro To Linux
A brief run through of the Linux OS and some commands for students that may not be familiar with the system
  - This is an optional section for students



                    Section 2 - In-Depth Scanning
1 - Scanning For Targets
The principle goal of scanning is to learn more about target and find openings
  - This is done by interacting with the environment of the target
  - You as a pentester need to understand the attack surface
  - You also need to be able to use the necessary tools effectively
Some of the things that can be determined are
  - Network addresses of firewalls, routers, hosts etc on that network
  - If possible determine the Network topology of the target
  - OS types of hosts can be determined using fingerprinting
  - Any open ports or running network sevices on the the target
  - Potential vulnerabilities of the target environment
  - These should all be done as quietly as possible, without impairing the target

Scan Types
There are several different types of scan depending on your needs
  - Network Sweeping
    - This is where you send a series of probe packets to id live hosts at IP addresses on the target network
  - Network Tracing
    - This is to help you determine the topology and build a map of the network
  - Port Scanning
    - Determine listening TCP & UDP ports on the system
  - OS Fingerprinting
    - To determine the OS on the target based on network activity 
  - Version Scanning
    - Determining the versions of services and protocols being used by open ports
  - Vulnerability Scanning
    - Put together a list of potential vulerabilities in the target system
    - These can be from misconfigurations, out of date versions of software, unpatched systems etc
  

2 - Profiling The Target

3 - Vulnerability Scanning

4 - Enumerating Users

5 - Netcat For The Pentester



                    Section 3 - Exploitation
1 - Exploitation Fundamentals
This is where the section on exploitation commences
  - There is just a quick run through of the section agenda to get started
An exploit is code or a technique that a threat uses to take advantage of a vulnerability
  - From a pen testers perspective exploitation normally involves getting shell access to run commands on a target machine
  - This could be with either limited or preferably super user privileges 
There are many things that can be doing once a target has been exploited
  - Move files to and from a target machine
  - Sniff network packets on the target machines
    - This may already be built in eg TCPDump
  - Reconfigure or install software on the target machine
    - This can be dangerous as it may lead to issues
Why Do Exploitation
  - The reduction and hopefully elimination of false positives
    - Even if the exploit does not work the vulnerability should still be reported as that may change
  - There is concrete proof of a vulnerability and therefore a more realistic treatment of risk
  - One machine can be used as a pivot point to get deeper inside the network
    - This again gives a more realistic sense of what a real attacker could do 
  - Exploitation leads on to post-exploitation
    - This can be an eye opening situation as it really shows the organisational risks from vulnerabilities

2 - Metasploit

3 - AV Evasion With Veil-Evision

4 - Metasploit Database And Tool Integration

5 - Pivot Port Relay

6 - Post Exploit With Empire



                    Section 4 - Post-Exploitation and Merciless Pivoting
1 - Moving Files With Exploits
A quick run through of the previous section
How to move files once you have compromised a target machine
Pulling data from target machines if referred to by 2 different terms interchangably
  - Pilfering & Pillaging
Some penetration test rules may prevent using the Wininternals psexec tool to communicate with other Windows systems
Dependending on the access that you have gained to a machine you may
  - Push files to a target machine
  - Use the target machine to pull files in
  - Which ever one is used will depend on several factors including privilige levels and firewall rules
  - Penetration testing requires flexibility of thinking and an open mind
Some of the different ways to move files are
  - TFTP -- Trivial File Transfer Protocol 
    - This is unauthenticated and is on UDP port 69
    - Most systems do use a TFTP client
  - FTP -- File Transfer Protocol 
    - This is fairly common software
    - It uses 2 different ports, TCP 20 for data and TCP 21 for control
    - It will correct text file anomalies between systems 
  - SCP -- Secure Copy Protocol
    - This is part of the SSH suite and encrypts data
    - It is often allowed outbound which uses the TCP 22 port by default
    - It is a part of most *nix systems by default
  - HTTP/HTTPS - Hyper Text Transfer Protocol / Secure
    - This is almost always allowed outbound an TCP 80 & TCP 443 ports
    - There are even supports for transfer through HTTP/HTTPS proxy
    - Command line browsers can be a very helpful tool eg wget, Lynx, HTTrack
There are some additional methods available to move files
  - Windosw file sharing such as SMB & NetBIOS
  - NFS Mounts
  - Netcat
  - Some of these must have the appropriate server and client installed

2 - Windows Command Line Kung Fu for Penetration Testing

3 - Remotely Run Windows Commands

4 - Powershell Kung-Fu For Penetration Testers

5 - Password Attacks

6 - Password Representation Attacks

7 - Advanced Hash Manipulation



                    Section 5 - In-Depth Password Attacks and Web App Pen Testing
1 - Overview Of Password Attack And Web App Pen Testing

2 - Advanced Password Attacks

3 - Pass The Hash Attacks

4 - Web Vulnerability Scanning And Web Proxies

5 - Injection Attacks

                    

                    Section 6 - Penetration Test & Capture the Flag Workshop
1 - Pen-Testing Workshop                    
                  
