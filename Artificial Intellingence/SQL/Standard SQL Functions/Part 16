Exercise
Calculate the average delay time for all the flights which took place in August (any year).

Solution
select avg(delay)
from flight
where extract(month from date)='08' 


Exercise
For each route, show its code together with the number of flights on that route and the average delay on that route. 
Only take into account flights older than 6 months. Don't show the routes with zero flights on it or NULL average delay. 
The column names should be: code, count, and avg.

Solution
select r.code, count(f.id) as count,
avg(f.delay) as avg
from route r
join flight f
on f.route_code = r.code
where f.date < current_date - interval '6' month
group by r.code


Exercise
Group all the flights by the year. Show the year (as year) and calculate the average delay time for each of those years (as avg).

Solution
select avg(delay),
extract(year from date) as year
from flight
group by year


Exercise
Count the number of distinct aircraft which were used during flights in August 2015. Name the column aircraft_no.

Solution
select count(distinct(aircraft_id)) as aircraft_no
from flight
where date between '2015-08-01' and '2015-09-01'



Instruction
All right. Before we start, we'll introduce our today's guest: Mr. Adams. 
He is CEO for Highland Furniture. â€“ a company which sells furniture and home accessories. 
He's agreed to show us a snippet of his product table. Let's see what's in there before we move on.

Exercise
Select all columns for the table product and study the contents.

Solution
select * from product



Instruction
Good. Let's get started and refresh your memory about NULLs.
A NULL means that the value in question is unknown or missing. In a client table, you could have a NULL last name because you forgot to ask your client for it.
In your product table, you could have a NULL product launch date if it hasn't been introduced yet. 
A NULL product price doesn't mean that the product is free, it simply means that the price is unknown.
We use the operators IS NULL or IS NOT NULL to check, respectively, if the value is missing or not, just like this:

SELECT *
FROM product
WHERE category IS NULL

Solution
select name 
from product 
where launch_date is not null


Exercise
Now, select name for all the products whose category is NULL.

Solution
select name
from product
where category is null



Instruction
Let's explain the behavior of NULL in detail. It's very important to understand it well as it is the source of frequent mistakes when writing SQL queries.
Let's talk about NULL and equality. The condition:

price = 5.99

is not met when the value for price is NULL. Well, that's quite obvious, NULL doesn't equal 5.99 after all.
What's more, NULL never satisfies the equality condition. It may seem less obvious that the condition

price = NULL

is NEVER true, even if the price is a NULL indeed. Keep in mind that you need to use IS NULL or IS NOT NULL instead of the equality sign

Exercise
See for yourself that the equality sign will not work. In our table, there is a row with a NULL launch_date. 
You can check that by clicking the Database icon on the right. Now, run the query we've prepared and try to find the row.

Solution
SELECT *
FROM product
WHERE launch_date = NULL
