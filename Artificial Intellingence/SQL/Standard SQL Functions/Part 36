Exercise
For each person, show the first and last name along with the precise weight, weight rounded down to the next integer (name the column weight_down) 
and weight rounded up to the next integer (name the column weight_up)

Solution
select
	first_name,
    last_name,
    weight,
	floor(weight)as weight_down,
    ceil(weight) as weight_up
from person


Exercise
For each branch, show its id, country, city and the average iq of members of this branch, 
rounded to 2 decimal places (name the column average_iq). Treat NULL values as 152.

Solution
select
    b.id,
    b.country, 
    b.city,
    round(avg(coalesce(p.iq, 152)), 2) as average_iq
from branch b
join person p
on p.branch_id = b.id
group by b.id, b.country, b.city


Exercise
For each person who registered earlier than 3 months ago, show their first_name, last_name and the interval showing how long they've been a member 
(subtract the registration_date from current_date). Name the last column days.

Solution
select 
	first_name,
    last_name,
    (current_date - registration_date) as days
from person
where registration_date < (current_date - interval '3' month)


Exercise
Count the number of people who registered in each month of 2015. Name the columns month and people_no. 
The month should be expressed as a number, e.g. 3 (you don't need to cast it to some other type). Don't show months where no registrations took place.

Solution
select 
	extract(month from registration_date) as month,
    count(id) as people_no
from person
where extract(year from registration_date) = 2015
group by month


Exercise
For each person, show the first and last name along with a third column named iq_rating. 
When the iq is below 149, show 'high', when it's between 149 and 152, show 'very high', when it is above 152, show 'highest', and when it's NULL, show 'missing'.

Solution
select
    first_name,
    last_name,
    case
      when iq < 149 then 'high'
      when iq between 149 and 152 then 'very high'
      when iq > 152 then 'highest'
      else 'missing'
    end as iq_rating
from person


Exercise
For each branch, show the id, country, city and count the number of people with the highest IQ (156) in these branches (name the column num_of_highest). 

Solution
select
    b.id,
    b.country, 
    b.city,
    sum(
      case iq
      	when 156 then 1
        else 0
      end
    ) as num_of_highest
from branch b
join person p


Exercise
For each branch, show its id, country, city and three more columns:

Solution
select
    b.id,
    b.country, 
    b.city,
    count(case
      when p.iq < 149 then p.id
    end) as count_high,
    count(case
      when p.iq between 149 and 152 then p.id
    end) as count_very_high,
    count(case
      when p.iq > 152 then p.id
    end) as count_highest
from branch b
join person p
on p.branch_id = b.id
group by b.id, b.country, b.city
    count_high (iq below 149),
    count_very_high (iq 149-152),
    count_highest (iq above 152),

each of them showing the number of people with the respective iq in specific branches.
