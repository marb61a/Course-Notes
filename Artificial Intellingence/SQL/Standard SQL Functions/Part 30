Instruction
Now, let's combine CASE WHEN with some aggregate functions.
You've learned the function SUM(), the constructions CASE WHEN and you know that CASE WHEN can return numbers. 
Now, let's combine all of this information to make a very convenient query which can count various groups of rows at the same time. Take a look:

SELECT
  SUM(CASE
    WHEN scholarship IS TRUE THEN place_limit
    ELSE 0
  END) AS scholarship_places,

  SUM(CASE
    WHEN scholarship IS FALSE THEN place_limit
    ELSE 0
  END) AS no_scholarship_places
FROM course;

The above query counts two SUMs: the number of places in all courses which offer scholarship and the number of places in those which don't.
Inside SUM, we put a CASE WHEN statement. When the value in the column scholarship is true, 
then we add the value from the column place_limit to the sum called scholarship_places. 
Otherwise, we add 0. The other SUM is calculated in the same way.

Exercise
Calculate the total sum from fees paid on June 3, 2015 (column june_3rd) and the total sum from fees paid on June 4, 2015 (column june_4th).

Solution
select
	sum(
    	case
      		when pay_date = '2015-06-03' then fee
      		else 0 
      	end
    )as june_3rd,
    sum(
    	case
      		when pay_date = '2015-06-04' then fee
      		else 0
      	end
    ) as june_4th
from application



Instruction
Now, let's use SUM in another way. Take a look:

SELECT
  SUM(CASE WHEN pay_date BETWEEN '2015-06-01' AND
    '2015-06-05' THEN 1 ELSE 0 END)
    AS accepted_payment,
  SUM(CASE WHEN pay_date = '2015-06-06' THEN 1
    ELSE 0 END) AS conditionally_accepted_payment,
  SUM(CASE WHEN pay_date > '2015-06-06'
    THEN 1 ELSE 0 END) AS not_accepted
FROM application;

In the above query, we start with calculating the number of accepted payments.
Inside the function SUM, we use a CASE WHEN construction. It checks whether the pay_date in a given row is within the deadline specified. 
If it is, this row is given the number 1 (which means the sum count will go up by 1). 
If this is not the case, the number is 0 and this row will not affect the sum (e.g., 10 plus 0 is still 10).
The other two SUM functions (conditionally_accepted_payment, not_accepted) work in the same way.

Exercise
Count the number of applications that have:

    a full fee of 50 (full_fee_sum).
    a fee of 10 (reduced_fee_sum).
    a fee of 0 (free_sum).
    a fee of NULL (null_fee_sum).

Solution
select
    sum(
    	case
      		when fee = 50 then 1
      		else 0
      	end
    ) as full_fee_sum,
    sum(
    	case
      		when fee = 10 then 1
      		else 0
      	end
    ) as reduced_fee_sum,
    sum(
    	case
      		when fee = 0 then 1
      		else 0
      	end
    ) as free_sum,
    sum(
    	case
      		when fee is null then 1
      		else 0
      	end
    ) as null_fee_sum
from application
