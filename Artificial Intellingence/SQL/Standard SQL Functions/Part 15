Instruction
BETWEEN is often used with intervals when we want to find facts for a specific month.
We no longer need to check whether a given month has 28, 29 (February), 30 or 31 days, the database will do that for us.

SELECT id
FROM aircraft
WHERE produced BETWEEN '2010-01-01' AND CAST('2010-01-01' AS date) + INTERVAL '1' MONTH;

Check it out for yourself!

Exercise
Count the number of flights performed in August 2015. Name the column flight_no.

Solution
select count(aircraft_id) as flight_no 
from flight
where date between '2015-08-01'
and cast('2015-08-01' as date) 
+ interval '1' month 



Instruction
Okay, let's move on â€“ now we'll learn a practical application for intervals. But let's start from the beginning.
Our database knows the current date and time. It has three functions which can come in handy:

    current_date returns the current date.
    current_time return the current time.
    current_timestamp returns the current date with time and timezone.

Note that we don't use parentheses () after the function name, even though we indeed use a function. You can use them in the following way:
SELECT current_date, current_time, current_timestamp;

Exercise
Run the template query and analyze the result.
The functions current_date, current_time, and current_timestamp return the current time for the database server (in our case: UTC). 
Depending on where you are, this may or may not be the same as your local time.

Solution
SELECT
  current_date,
  current_time,
  current_timestamp;
  


Instruction
How can we use these functions in our queries? We can use them to find facts which took place in the last week, last month etc. Take a look:

SELECT id
FROM flight
WHERE date > CURRENT_DATE - INTERVAL '7' DAY;

The above query will find all flights which took place in the last 7 days.
We use the structure INTERVAL 'x' UNIT where x is the number and UNIT is SECOND, MINUTE, HOUR, DAY, MONTH or YEAR.
Our database takes the current date and puts it back 7 days.

Exercise
Find the id of all the aircraft which were produced earlier than 3 months ago.

Solution
select id
from aircraft
where produced
< current_date - interval '3' month


Exercise
Find the code of all the routes which normally depart within 3 hours from the current time.

Solution
select code
from route
where departure
between current_time and
current_time + interval '3' hour


Exercise
Show the code, from_airport, and to_airport for all those routes which depart between 9:00 AM and 3:00 PM.

Solution
select code,
from_airport, to_airport
from route 
where departure
between '09:00:00' and '15:00:00'


Exercise
For all the flights which took place on July 11, 2015, show the from_airport, to_airport, and the model of the aircraft.

Solution
select r.from_airport,
r.to_airport, a.model
from flight f
join aircraft a
on a.id = f.aircraft_id
join route r
on f.route_code = r.code
where f.date = '2015-07-11'

