Instruction
Ok, one more thing to make it slightly more complicated: remember that foreign key columns are columns like any other 
and they can be used just the way any other column is used. For instance they can be part of a primary key. Sounds vague? Take a look at the ERD:
We've got three tables.
The first one, employee, is a table we know already. It stores information about employees in our company.
The second table is called position. This is where we can keep information about the positions offered at our company, like accountant, junior associate etc.
There is also a third table called job_history which is meant to keep track of an employee's position history in the company, 
because each employee can work at various positions and each position can be occupied by various employees. 
Each row in the table job_history corresponds to a single employee (column employee_id) working on a single position (column position_id) from start_date until end_date.
There is another column called seq which we added because each employee may work several times on the same position when their role in the company changes.
So, as you can see, the table job_history takes employee_id from the table employee as a foreign key and position_id from the table position, also as a foreign key.
But these two values, together with the column seq, also create the primary key of the table job_history. 
Hence, employee_id and position_id are foreign keys and parts of the primary key at the same time. 

Exercise
That was a lot of theory, wasn't it? Let's create the table in question, job_history. Use the ERD diagram above to help you.

Solution
CREATE TABLE job_history(
	employee_id INT,
  	position_id INT,
  	seq INT,
  	start_date DATE NOT NULL,
  	end_date DATE NULL,
  	PRIMARY KEY (employee_id, position_id, seq),
  	FOREIGN KEY (employee_id)
  	REFERENCES employee(id),
  	FOREIGN KEY (position_id)
  	REFERENCES position(id)
)


Exercise
Select first_name and last_name of each employee together with the title of their current position. Use the ERD below to help you.
Hints:

    (a) you will need to use JOIN twice to join the three tables
    (b) if you only want to retrieve the current position of each employee, remember that the filed end_data for that particular row in job_history will be NULL.


Solution
SELECT
	e.first_name,
    e.last_name,
    p.title
FROM employee e
JOIN job_history j
ON j.employee_id = e.id
JOIN position p
ON p.id = j.position_id
WHERE j.end_date IS NULL


Exercise
Let's check that once again. Try to take the employee with id = 1 from the table employee and change the id to 107. 

Solution
// No Solution needed but an example solution
UPDATE employee SET id = 107 WHERE id = 1;


Instruction
Just as we expected - we failed. Why is that so? Because when we write REFERENCES... after FOREIGN KEY (...), 
we actually mean REFERENCES ... ON UPDATE RESTRICT ON DELETE RESTRICT. 
In other words, the database won't allow to update or delete a primary key which is linked to another table with a foreign key.
There are, however, other options too. Instead of RESTRICT, we can use:

    CASCADE - when the referenced row is deleted or updated, the respective rows of the referencing table will be deleted or updated.
    NO ACTION - do nothing to the the referenced row (in our database this is the same as RESTRICT, in some databases NO ACTION is slightly different from RESTRICT).
    SET NULL - the values of the affected rows are set to NULLs.
    SET DEFAULT - the values of the affected rows are set to their default values.

Exercise
Run the template code to create a new version of the table project - this time with CASCADE. Take a close look at how it's done.

Solution
CREATE TABLE project (
  id int PRIMARY KEY,
  name varchar(1000)  NOT NULL,
  description varchar(255)  NOT NULL,
  manager_id int  NOT NULL,
  FOREIGN KEY (manager_id) REFERENCES employee (id) ON DELETE CASCADE ON UPDATE CASCADE,
)


Exercise
Let's see what happens in the table project when we update an id in the table employee. Take the employee with id 2 and change the id to 20.

Solution
UPDATE employee SET id = 20 WHERE id = 2;


Exercise
Now, we want to check what happens if we delete an employee. Ok, we've returned the good old id 2 to Oliver Powell because he wasn't really happy about id 20.
Now, try to delete him (id 2) from the table employee.

Solution
DELETE FROM employee WHERE id = 2
