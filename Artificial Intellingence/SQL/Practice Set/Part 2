Exercise
Select all data from the games table.

As you can see, this table consists of the following columns:

    id – the id of a given game,
    title – the title of a given game,
    company – the name of a company that produced a given game,
    type – the genre of a given game,
    production_year – the year in which a game was created,
    system – the system for which a game was released,
    production_cost – the cost of producing of a given game,
    revenue – the revenue a given game generated,
    rating – the rating of a given game.

Solution
select * from games



Exercise
Select all data from the games table and order the results by the cost of the production from the cheapest to the most expensive. 
If the cost of production is the same, order by ratings from best to worst.

Solution
select * from games
order by production_cost asc,
rating desc



Exercise
Show the average production cost of games that were produced between 2010 and 2015 and were rated higher than 7.

Solution
select avg(production_cost) from games
where production_year between 2010 and 2015
and rating > 7



Exercise
What was the total revenue for all shooter games that were created after 2010 and rated higher than 3? 

Solution
select sum(revenue) from games
where type = 'shooter'
and production_year > 2010
and rating  > 3



Exercise
For each year, display the year (production_yearcode>, count how many games were released in this year (as the count column), 
what was the average cost of production (as the avg_cost column), and what was their average revenue (as the avg_revenue column).

Solution
select production_year, 
count(id) as count, 
avg(production_cost) as avg_cost,
avg(revenue) as avg_revenue 
from games
group by production_year



Exercise
Count how many games of a given type turned out to be profitable (their revenue was greater than the production cost).
Show the number of games (as number_of_games) and the type column.

Solution
select count(id) as number_of_games, type
from games where
(revenue - production_cost > 0) 
group by type



Exercise
For all companies present in the table, show their name and the sum of gross profit over all years.
To simplify this problem, assume that the gross profit is revenue - cost of production, show this column as sum.
Show the results starting with the company that had the highest gross profit.

Solution
select company,
sum(revenue - production_cost) as sum
from games
group by company
order by sum desc



Exercise
For each company, select its name, the number of games it produced, the average cost of production.
Show only these companies that produced more than one game.

Solution
select company, count(ID), 
avg(production_cost)
from games
group by company
having count(ID) > 1



Exercise
We're interested in good games produced between 2000 and 2009.
A good game is a game that got rating higher than 6 and was profitable.
For each company show company name, its total revenue from good games produced between 2000 and 2009, and the number of good games it produced in this period.
Only show companies with good-game revenue over 3 000 000.

Solution
select company, sum(revenue), count(id) 
from games
where production_year between 2000 and 2009
and rating > 6
and (revenue - production_cost > 0)
group by company
having sum(revenue) > 3000000
