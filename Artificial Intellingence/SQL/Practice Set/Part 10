Exercise
Show the names of the most experienced members of each orchestra and the name of that orchestra. Rename the columns to member and orchestra, respectively.

Solution
SELECT
	o.name as orchestra,
    m.name as member
FROM orchestras o
JOIN members m 
ON o.id = m.orchestra_id
JOIN (
	SELECT
  	  m1.orchestra_id,
  	  max(m1.experience) as experience
  	FROM members m1
    GROUP BY m1.orchestra_id
) AS m2
ON m2.orchestra_id = m.orchestra_id
AND m2.experience = m.experience


Exercise
Show name of orchestra members who earn more than the average wage of the violinists from their orchestra.

Solution
SELECT
	m.name
FROM members m,(
	SELECT
  	  orchestra_id,
  	  AVG(wage)
  	FROM members
  	WHERE position = 'violin'
    GROUP BY orchestra_id
)m2
WHERE m.orchestra_id = m2.orchestra_id
AND m.wage > AVG


Exercise
Select the name, rating, city of origin, and the total number of concerts it held in Ukraine for each orchestra that originated in Germany. Name the last column count

Solution
SELECT
	o.name,
    o.rating,
    o.city_origin,
(
  	SELECT COUNT(*) 
  	FROM concerts c 
	WHERE c.orchestra_id = o.id AND c.country = 'Ukraine'
)
COUNT
FROM orchestras o
WHERE o.country_origin = 'Germany'


Instruction
In this section, we'll work with four tables. You've encountered three of them before, so this will serve as a quick refresher.
    artist,
    museum,
    piece_of_art,
    museum_loan.

Let's get started with the artist table.

Exercise
Select all data from the artist table. It consists of the following columns:
    id – the ID of a given artist,
    name – the name of a given artist,
    birth_year – the year of birth of a given artist,
    death_year – the year of death of a given artist,
    artistic_field – the field of art that a given artist focused on,
    country_origin – the name of the country in which a given artist was born.

Solution
SELECT * FROM artist


Exercise
Select all data from the museum table.
It only consists of the following three columns:
    id – the ID of a given museum,
    name – the name of a given museum,
    country – the country in which a given museum is located.

Solution
SELECT * FROM museum


Exercise
Select all data from the piece_of_art table.
As you can see it has these four columns:
    id – the ID of a given piece of art,
    name – the name of a given piece of art,
    artist_id – the ID of the artist who created a given piece of art,
    museum_id – the ID of the museum that houses a given piece of art in its collection.

Solution
SELECT * FROM piece_of_art
