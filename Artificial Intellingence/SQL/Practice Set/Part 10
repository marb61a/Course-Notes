Exercise
Show the names of the most experienced members of each orchestra and the name of that orchestra. Rename the columns to member and orchestra, respectively.

Solution
SELECT
	o.name as orchestra,
    m.name as member
FROM orchestras o
JOIN members m 
ON o.id = m.orchestra_id
JOIN (
	SELECT
  	  m1.orchestra_id,
  	  max(m1.experience) as experience
  	FROM members m1
    GROUP BY m1.orchestra_id
) AS m2
ON m2.orchestra_id = m.orchestra_id
AND m2.experience = m.experience


Exercise
Show name of orchestra members who earn more than the average wage of the violinists from their orchestra.

Solution
SELECT
	m.name
FROM members m,(
	SELECT
  	  orchestra_id,
  	  AVG(wage)
  	FROM members
  	WHERE position = 'violin'
    GROUP BY orchestra_id
)m2
WHERE m.orchestra_id = m2.orchestra_id
AND m.wage > AVG


Exercise
Select the name, rating, city of origin, and the total number of concerts it held in Ukraine for each orchestra that originated in Germany. Name the last column count.

Solution
