Instruction
Let's continue the adventure. In Part 5, we learned window frames. Let's take a look at the following example:

SELECT
  id,
  payment_date,
  payment_amount,
  SUM(payment_amount) OVER(
    ORDER BY payment_date
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)
FROM subscription;

In the above query, we calculate a running total paid for all subscriptions up to the current row.

Exercise
For each single rental, show the id, rental_date, payment_amount and the running total of payment_amounts of all rentals from the oldest one 
(in terms of rental_date) until the current row.

Solution
select
	id,
    rental_date,
    payment_amount,
    sum(payment_amount) over(
      order by rental_date asc
      rows between unbounded preceding
      and current row
    )
from single_rental


Exercise
For each single rental, show its id, rental_date, platform, payment_date, payment_amount and the average payment amount calculated 
by taking into account the previous two rows, the current row and the next two rows when sorted by the payment_date.

Solution
select
    id,
    rental_date,
    platform,
    payment_date,
    payment_amount,
    avg(payment_amount) over(
      order by payment_date asc
      rows between 2 preceding
      and 2 following
    )
from single_rental
