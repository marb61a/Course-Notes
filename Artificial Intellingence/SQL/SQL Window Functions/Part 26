Exercise
For each row, show the following columns: store_id, day, customers and the number of clients in the 5th greatest store in terms of the number of customers on that day

Solution
select
    store_id,
    day,
    customers,
    nth_value(customers, 5) over(
      partition by day
      order by customers desc
      rows between unbounded preceding
      and unbounded following
    )
from sales


Exercise
Select all the information from the repairs table.
Our repair workshop collects statistics for popular phones. 
Each row contains the phone name, the day, the number of free repairs performed (as part of warranty), 
the number of paid repairs performed on that day and the revenue generated by the paid repairs.

Solution
select * from repairs


Exercise
For each day, show the following two columns: day and the name of the second most frequently repaired phone on that day. Only take into account free_repairs.

Solution
with ranking as (
  select
    day,
	phone,
    rank() over(
      partition by day
      order by free_repairs desc
    )
  from repairs
)

select
	day,
    phone
from ranking
where rank = 2

