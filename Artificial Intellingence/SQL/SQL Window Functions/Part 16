Exercise
Select all the information from the revenue table.
There are only three columns: department_id, year and amount. Mind you, you will need to write very similar queries in this part. The devil's in the detail!

Solution
select * from revenue


Exercise
For each row from department with id = 2, show its department_id, year, amount and the total amount from the current year + two previous years.

Solution
select
	department_id,
    year,
    amount,
    sum(amount) over(
      order by year
      rows 2 preceding
    )
from revenue
where department_id = 2


Exercise
For each row from department with id = 1, show its department_id, year, amount and the running average amount from all rows up to the current rows, sorted by the year.

Solution
select
	department_id,
    year,
    amount,
    avg(amount) over(
      order by year
    )
from revenue
where department_id = 1


Exercise
For each row sorted by the year, show its department_id, year, amount, 
the average amount from all departments in the given year and the difference between the amount and the average amount.

Solution
select
	department_id,
    year,
    amount,
    avg(amount) over(
      partition by year
      range current row
    ),
    amount - avg(amount) over(partition by year)
from revenue
group by department_id,year,amount
